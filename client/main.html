<!--
To the extent possible under law, the author(s) have dedicated all copyright
and related and neighboring rights to this software to the public domain
worldwide. This software is distributed without any warranty. You should have
received a copy of the CC0 Public Domain Dedication along with this software.
If not, see <http://creativecommons.org/publicdomain/zero/1.0/>.
-->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1 user-scalable=0"/>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Project Riemann</title>
</head>

<body>
  {{> page}}
</body>

<template name="page">
  {{> facebook}}
  <div class="nDarkenScreen"></div>
  <div class="nWrapper">
    <div class="nBubble">
      <p>Simply send this URL to your opponent!</p>
      <p><button class="btn nOkUrlCalloutButton">OK</button></p>
    </div>

    <div class="nContainer">

      <header class="nHeader" role="banner">
        <span class="nMenuToggleButton">
          <i class="icon-reorder"></i>
        </span>
        {{> moveControls}}
      </header>

      <nav class="nNavigation" role="navigation">
        <img class="nLogo" src="/images/logo300.png" />
        {{> navBody}}
      </nav>

      <div class="nMain" role="main">
        <div class="nDesktopHeader">
          {{> moveControls}}
        </div>
        <div class="nGame" id="nIdGame">
          <div class="nLoading">
            Loading...
          </div>
          {{> newGamePromo}}
          {{> newGameMenu}}
          <div class="nFacebookInviteMenu"></div>
        </div> <!--/nGame-->
        <div class="nNotification"></div>
      </div> <!--/nMain-->
    </div> <!--/nContainer-->
  </div> <!--/nWrapper-->
  <div class="modal hide fade nResignConfirmModal" tabindex="-1" role="dialog"
      aria-hidden="true">
    <div class="modal-header">
      <h3>Confirm Leaving</h3>
    </div>
    <div class="modal-body">
      <p>Are you sure you want to leave this game?</p>
    </div>
    <div class="modal-footer">
      <button class="btn" data-dismiss="modal" aria-hidden="true">
        Cancel
      </button>
      <button class="btn btn-danger nResignConfirmButton">
        Leave game
      </button>
    </div>
  </div>
</template>

<template name="navBody">
  <div class="nNavBody">
    <div class="nNavItem">
      <span class="nGameListIcon nGameListNewGameIcon">
        <i class="icon-play icon-large"></i>
      </span>
      <div class="nGameListDescription nNavNewGameDescription">
        <a href="/new">New Game</a>
      </div>
    </div>
    {{#if games.myTurn}}
      <div class="nNavigationSectionHeader">Your Move:</div>
    {{/if}}
    {{#each games.myTurn}}
      {{> gameListing}}
    {{/each}}
    {{#if games.theirTurn}}
      <div class="nNavigationSectionHeader">Their Move:</div>
    {{/if}}
    {{#each games.theirTurn}}
      {{> gameListing}}
    {{/each}}
  </div>
</template>

<template name="gameListing">
  <div class="nNavItem nGameListing
      {{#if isCurrentGame}}nCurrentGame{{/if}}"
      gameId={{gameId}}>
    {{#if hasOpponent}}
      {{#if opponentHasProfile}}
        <img class="nGameListProfilePicture"
            src="{{opponentPhoto}}" />
      {{else}}
        <span class="nGameListIcon">
          <i class="icon-user icon-2x"></i>
        </span>
      {{/if}}
    {{else}}
      <span class="nGameListIcon">
        <i class="icon-minus-sign icon-2x"></i>
      </span>
    {{/if}}
    <div class="nGameListDescription">
      {{#unless isCurrentGame}}
        <a href="/{{gameId}}">
      {{/unless}}
      {{#if hasOpponent}}
        {{#if opponentHasProfile}}
          Game vs. {{opponentProfile.givenName}}
        {{else}}
          Game vs. Anonymous
        {{/if}}
      {{else}}
        Game - No Opponent
      {{/if}}
      {{#unless isCurrentGame}}
        </a>
      {{/unless}}
      <div class="nGameLastModifiedTime">
        Updated {{lastModified}}
      </div>
    </div>
    <i class="icon-remove nResignGameButton" gameId={{gameId}}></i>
    <span class="nResignTooltip">Leave Game</span>
  </div>
</template>

<template name="newGamePromo">
  <div class="nNewGamePromo">
    <div class="nGameDescription">
      "Noughts and Crosses", also known as "Tic-Tac-Toe" and "Xs and Os", is
       a game for two players.
    </div>
    <div class="nPromoButtonContainer">
      <button type="button" class="btn nMenuButton nNewGameButton">
        <i class="icon-play icon-large"></i>
        <span class="nMenuButtonText">New Game</span>
      </button>
    </div>
  </div> <!--/nNewGamePromo-->
</template>

<template name="newGameMenu">
  <div class="nNewGameMenu">
    <div class="nNewGameMenuHeader">
      New Game:
    </div>
    <button type="button" class="btn nMenuButton nFacebookInviteButton">
      <div class="nMenuButtonIcon">
        <i class="icon-facebook-sign icon-large"></i>
      </div>
      <span class="nMenuButtonText">Invite via Facebook</span>
    </button>
    <button type="button" class="btn nMenuButton nVsComputerButton">
      <div class="nMenuButtonIcon">
        <i class="icon-laptop icon-large"></i>
      </div>
      <span class="nMenuButtonText">Play vs. Computer</span>
    </button>
    <button type="button" class="btn nMenuButton nLocalMultiplayerButton">
      <div class="nMenuButtonIcon">
        <i class="icon-group icon-large"></i>
      </div>
      <span class="nMenuButtonText">Local Multiplayer</span>
    </button>
    <button type="button" class="btn nMenuButton nUrlInviteButton">
      <div class="nMenuButtonIcon">
        <i class="icon-link icon-large"></i>
      </div>
      <span class="nMenuButtonText">Invite via URL</span>
    </button>
    <button type="button" class="btn nMenuButton nNewGameMenuCloseButton">
      <div class="nMenuButtonIcon">
        <i class="icon-remove icon-large"></i>
      </div>
      <span class="nMenuButtonText">Cancel</span>
    </button>
  </div>
</template>

<template name="facebookInviteMenu">
  <div class="nNewGameMenuHeader">
    Invite Opponent:
  </div>
  <select multiple="true" class="nFacebookFriendSelect">
    <option value=""></option>
    {{#each suggestedFriends}}
      <option value="{{this.uid}}">{{this.name}}</option>
    {{/each}}
  </select>
  <div class="nFacebookInviteMenuControls">
    <button type="button" class="btn nSmallButton nFacebookInviteCancelButton">
      <i class="icon-remove"></i>
      <span class="nMenuButtonText">Cancel</span>
    </button>
    <button type="button" class="btn nSmallButton nSmallFacebookInviteButton"
        disabled="disabled">
      <i class="icon-facebook-sign"></i>
      <span class="nMenuButtonText">Send Invite</span>
    </button>
  </div>
</template>

<template name="facebookFriend">
  <img src="https://graph.facebook.com/{{uid}}/picture?type=square" />
  <strong class="nFacebookFriendName">{{name}}</strong>
</template>

<template name="gameUrl">
  <strong>https://noughts.meteor.com/?game_id={{gameId}}</strong>
</template>

<template name="facebook">
  {{#constant}}
    <div id="fb-root"></div>
  {{/constant}}
</template>

<template name="moveControls">
  <div class="nMoveControlsContainer">
    <button type="button" class="btn nMoveControlButton nUndoButton"
        disabled="disabled">
      <i class="icon-undo"></i>
    </button>
    <button type="button" class="btn nMoveControlButton nRedoButton"
        disabled="disabled">
      <i class="icon-repeat"></i>
    </button>
    <button type="button" class="btn nMoveControlButton nSubmitButton"
        disabled="disabled">
      <i class="icon-signout nSubmitIcon"></i>Submit
    </button>
  </div>
</template>
